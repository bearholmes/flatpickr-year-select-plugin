{"version":3,"file":"flatpickr-year-select-plugin.mjs","sources":["../src/plugin.ts"],"sourcesContent":["interface YearDropdownPluginConfig {\n  start?: number;\n  end?: number;\n  [key: string]: number | undefined;\n}\n\nconst yearDropdownPlugin = function (pluginConfig?: YearDropdownPluginConfig) {\n  const config: YearDropdownPluginConfig = {\n    start:\n      pluginConfig && pluginConfig.start !== undefined ? pluginConfig.start : 3,\n    end: pluginConfig && pluginConfig.end !== undefined ? pluginConfig.end : 3,\n  };\n\n  const currYear = new Date().getFullYear();\n\n  const yearWrapper = document.createElement(\"div\");\n  yearWrapper.classList.add(\"flatpickr-current-year\");\n  const yearDropdown = document.createElement(\"select\");\n  yearDropdown.classList.add(\"flatpickr-monthDropdown-years\");\n\n  //function (_year: number)\n  const createSelectElement = function (year: number) {\n    const start = config.start !== undefined ? year - config.start : year;\n    const end = config.end !== undefined ? year + config.end : year;\n\n    for (let i = start; i <= end; i++) {\n      const option = document.createElement(\"option\");\n      option.value = String(i);\n      option.text = String(i);\n      yearDropdown.appendChild(option);\n    }\n    yearDropdown.value = String(year);\n  };\n\n  return function (fp: any) {\n    if (!fp) return;\n    if (fp.config.minDate) {\n      const minDate = new Date(fp.config.minDate);\n      if (currYear >= minDate.getFullYear())\n        config.start = currYear - minDate.getFullYear();\n    }\n    if (fp.config.maxDate) {\n      const maxDate = new Date(fp.config.maxDate);\n      if (currYear <= maxDate.getFullYear())\n        config.end = maxDate.getFullYear() - currYear;\n    }\n\n    fp.yearSelectContainer = fp._createElement(\"div\", \"flatpickr-years\", \"\");\n\n    // fp.yearSelectContainer.tabIndex = -1;\n    createSelectElement(currYear);\n\n    yearDropdown.addEventListener(\"change\", function (evt) {\n      const target = evt.target as HTMLSelectElement;\n      if (!target) return;\n      const year = target.options[target.selectedIndex].value;\n\n      fp.changeYear(Number(year));\n      fp.redraw();\n    });\n\n    yearWrapper.append(yearDropdown);\n    fp.yearSelectContainer.append(yearWrapper);\n\n    return {\n      onReady: function onReady() {\n        const name = fp.monthNav.className;\n        const yearInputCollection =\n          fp.calendarContainer.getElementsByClassName(name);\n        const el = yearInputCollection[0];\n        if (!el) return;\n        el.parentNode.insertBefore(\n          fp.yearSelectContainer,\n          el.parentNode.firstChild\n        );\n\n        const start =\n          config.start !== undefined ? currYear - config.start : currYear;\n        const end = config.end !== undefined ? currYear + config.end : currYear;\n\n        if (!fp.config.minDate) fp.set(\"minDate\", `${start}-01-01`);\n        if (!fp.config.maxDate) fp.set(\"maxDate\", `${end}-12-31`);\n      },\n      onOpen: function onOpen(\n        _selectedDates: any,\n        _dateStr: any,\n        instance: { currentYear: any }\n      ) {\n        yearDropdown.value = String(instance.currentYear);\n      },\n      onYearChange: function onYearChange(\n        _selectedDates: any,\n        _dateStr: any,\n        instance: { currentYear: any }\n      ) {\n        yearDropdown.value = String(instance.currentYear);\n      },\n    };\n  };\n};\n\nexport default yearDropdownPlugin;\n"],"names":["yearDropdownPlugin","pluginConfig","config","currYear","yearWrapper","yearDropdown","createSelectElement","year","start","end","i","option","fp","minDate","maxDate","evt","target","name","el","_selectedDates","_dateStr","instance"],"mappings":"AAMM,MAAAA,IAAqB,SAAUC,GAAyC;AAC5E,QAAMC,IAAmC;AAAA,IACvC,OACED,KAAgBA,EAAa,UAAU,SAAYA,EAAa,QAAQ;AAAA,IAC1E,KAAKA,KAAgBA,EAAa,QAAQ,SAAYA,EAAa,MAAM;AAAA,EAAA,GAGrEE,KAAW,oBAAI,KAAK,GAAE,YAAY,GAElCC,IAAc,SAAS,cAAc,KAAK;AACpC,EAAAA,EAAA,UAAU,IAAI,wBAAwB;AAC5C,QAAAC,IAAe,SAAS,cAAc,QAAQ;AACvC,EAAAA,EAAA,UAAU,IAAI,+BAA+B;AAGpD,QAAAC,IAAsB,SAAUC,GAAc;AAClD,UAAMC,IAAQN,EAAO,UAAU,SAAYK,IAAOL,EAAO,QAAQK,GAC3DE,IAAMP,EAAO,QAAQ,SAAYK,IAAOL,EAAO,MAAMK;AAE3D,aAASG,IAAIF,GAAOE,KAAKD,GAAKC,KAAK;AAC3B,YAAAC,IAAS,SAAS,cAAc,QAAQ;AACvC,MAAAA,EAAA,QAAQ,OAAOD,CAAC,GAChBC,EAAA,OAAO,OAAOD,CAAC,GACtBL,EAAa,YAAYM,CAAM;AAAA,IACjC;AACa,IAAAN,EAAA,QAAQ,OAAOE,CAAI;AAAA,EAAA;AAGlC,SAAO,SAAUK,GAAS;AACxB,QAAKA,GACD;AAAA,UAAAA,EAAG,OAAO,SAAS;AACrB,cAAMC,IAAU,IAAI,KAAKD,EAAG,OAAO,OAAO;AACtC,QAAAT,KAAYU,EAAQ,YAAY,MAC3BX,EAAA,QAAQC,IAAWU,EAAQ,YAAY;AAAA,MAClD;AACI,UAAAD,EAAG,OAAO,SAAS;AACrB,cAAME,IAAU,IAAI,KAAKF,EAAG,OAAO,OAAO;AACtC,QAAAT,KAAYW,EAAQ,YAAY,MAC3BZ,EAAA,MAAMY,EAAQ,YAAA,IAAgBX;AAAA,MACzC;AAEA,aAAAS,EAAG,sBAAsBA,EAAG,eAAe,OAAO,mBAAmB,EAAE,GAGvEN,EAAoBH,CAAQ,GAEfE,EAAA,iBAAiB,UAAU,SAAUU,GAAK;AACrD,cAAMC,IAASD,EAAI;AACnB,YAAI,CAACC;AAAQ;AACb,cAAMT,IAAOS,EAAO,QAAQA,EAAO,aAAa,EAAE;AAE/C,QAAAJ,EAAA,WAAW,OAAOL,CAAI,CAAC,GAC1BK,EAAG,OAAO;AAAA,MAAA,CACX,GAEDR,EAAY,OAAOC,CAAY,GAC5BO,EAAA,oBAAoB,OAAOR,CAAW,GAElC;AAAA,QACL,SAAS,WAAmB;AACpB,gBAAAa,IAAOL,EAAG,SAAS,WAGnBM,IADJN,EAAG,kBAAkB,uBAAuBK,CAAI,EACnB,CAAC;AAChC,cAAI,CAACC;AAAI;AACT,UAAAA,EAAG,WAAW;AAAA,YACZN,EAAG;AAAA,YACHM,EAAG,WAAW;AAAA,UAAA;AAGhB,gBAAMV,IACJN,EAAO,UAAU,SAAYC,IAAWD,EAAO,QAAQC,GACnDM,IAAMP,EAAO,QAAQ,SAAYC,IAAWD,EAAO,MAAMC;AAE3D,UAACS,EAAG,OAAO,WAASA,EAAG,IAAI,WAAW,GAAGJ,CAAK,QAAQ,GACrDI,EAAG,OAAO,WAASA,EAAG,IAAI,WAAW,GAAGH,CAAG,QAAQ;AAAA,QAC1D;AAAA,QACA,QAAQ,SACNU,GACAC,GACAC,GACA;AACa,UAAAhB,EAAA,QAAQ,OAAOgB,EAAS,WAAW;AAAA,QAClD;AAAA,QACA,cAAc,SACZF,GACAC,GACAC,GACA;AACa,UAAAhB,EAAA,QAAQ,OAAOgB,EAAS,WAAW;AAAA,QAClD;AAAA,MAAA;AAAA;AAAA,EACF;AAEJ;"}